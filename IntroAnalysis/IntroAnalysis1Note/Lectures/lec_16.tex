\chapter{Formal Power Series}
\lecture{16}{30 Oct. 10:20}{}
\section{Review of series}
\begin{definition}
    Let \((a_n)_{n=1}^{\infty} \) be a sequence of real numbers,
    \begin{itemize}
        \item [(a)] The limit superior or (\(\limsup\)) of a sequence \((a_n)\) is defined by 
        \[\limsup_{n \to \infty} a_n = \lim_{n \to \infty} \sup _{k \ge n} a_k.  \]
        Let \(S_n = \sup _{k \ge n} a_k\). Note that the index set \(\left\{ k \ge n \right\} \) is larger than \(\left\{ k \ge n+1 \right\} \), so \(S_{n+1} \le S_n\). Equivalently, we can define \(\limsup_{n \to \infty} a_n = \lim_{n \to \infty} S_n  \), and since \(S_n\) is decreasing, so \(\lim_{n \to \infty} S_n \) exists, but it could be \(\infty \) or \(-\infty \). 
        \item [(b)] Similarly we can define 
        \[
            \liminf_{n \to \infty} a_n = \lim_{n \to \infty} \inf _{k \ge n} \inf a_k.  
        \] Let \(I_n = \inf _{k \ge n} a_k\), then we know \(I_n \le I_{n+1}\), so \(I_n\) is increasing, so \(\lim_{n \to \infty} I_n = \liminf_{n \to \infty} a_n  \) exists, but it could be \(\infty \) or \(-\infty \).     
    \end{itemize}
\end{definition}

\begin{eg}
    \begin{align*}
        \limsup_{n \to \infty} n &= \lim_{n \to \infty} \sup _{k \ge n} k = \infty . \\
        \liminf_{n \to \infty} n &= \lim_{n \to \infty} \inf _{k \ge n} k = \lim_{n \to \infty} n = \infty .  
    \end{align*}
\end{eg}

\begin{definition}
    Let \(\sum_{n=1}^{\infty} a_n \) be a series of real numbers, and let \(S_N = \sum_{n=1}^N a_n \), then we say \(\sum_{n=1}^{\infty} a_n \) converges if \(\lim_{N \to \infty} S_N\) exists and 
    \[
        \sum_{n=1}^{\infty} a_n = \lim_{N \to \infty} S_N. 
    \]
\end{definition}

\begin{theorem} \label{thm: if sum an converges, then lim an = 0}
    If \((a_n)\) is a sequence of real numbers, and if \(\sum_{n=1}^{\infty} a_n \) converges, then \(\lim_{n \to \infty} a_n = 0 \).   
\end{theorem}
\begin{proof}
    Suppose \(S_N = \sum_{n=1}^N a_n \), then we know \(S_{n+1} - S_n = a_{n+1}\), then we know 
    \[
        \lim_{n \to \infty} a_n = \lim_{n \to \infty} a_{n+1} = \lim_{n \to \infty} S_{n+1} - S_n = \lim_{n \to \infty} S_{n+1} - \lim_{n \to \infty} S_n = 0.    
    \]  
\end{proof}

\begin{corollary}
    If \((a_n)\) is a sequence of real numbers, and if \(\lim_{n \to \infty} a_n \) doesn't exist or \(\lim_{n \to \infty} a_n \neq 0 \), then \(\sum_{n=1}^{\infty} a_n \) diverges.   
\end{corollary}

\begin{definition}
    We say a real series \(\sum_{n=1}^{\infty} a_n  \) is absolutely convergent if \(\sum_{n=1}^{\infty} \vert a_n \vert  \) converges.
\end{definition}

\begin{theorem}
    If \((a_n)\) is a sequence of real numbers, and if \(\sum_{n=1}^{\infty} a_n \) converges absolutely, then \(\sum_{n=1}^{\infty} a_n \) converges.
\end{theorem}
\begin{proof}
    Let \(S_n = \sum_{i=1}^n a_i \), then suppose \(n \ge m\), then we have 
    \[
        \left\vert S_n - S_m \right\vert = \left\vert \sum_{i=m+1}^{n} a_n \right\vert \le \sum_{i=m+1}^n \vert a_i \vert.    
    \]  
    Let \(T_n = \sum_{i=1}^n \vert a_i \vert  \), then we know \(\left\vert T_n - T_m \right\vert = \sum_{i=m+1}^n \vert a_i \vert  \). Since \(\sum_{n=1}^{\infty} a_n \) converges absolutely, so \(\lim_{n \to \infty} T_n \) exists, and thus \(\left\{ T_n \right\} \) is Cauchy. Since
    \[
        \left\vert S_n - S_m \right\vert \le \left\vert T_n - T_m \right\vert, 
    \] so \(\left\{ S_n \right\} \) is also Cauchy, which means it is convergent. 
\end{proof}

\section{Formal Power Series}
\begin{definition}
    Let \(a \in \mathbb{R} \). A formal power series centered at \(a\) is any series of the form 
    \[
        \sum_{n=0}^{\infty} c_n (x - a)^n 
    \] where \(\left\{ c_n \right\}_{n=1}^{\infty}  \) is a sequence of real numbers. We refer \(c_n\) to the \(n\)-th coefficient of the series. Each term \(c_n(x - a)^n\) is a function of \(x\).     
\end{definition}

\begin{eg}
    \(\sum_{n=0}^{\infty} n! (x-2)^n \) is a formal power series centered at \(2\) but \(\sum_{n=0}^{\infty} 2^x (x-3)^n \) is not a formal power series since \(2^x\) depends on \(x\) not on \(n\).      
\end{eg}

\begin{definition}
    Let \(\sum_{n=0}^{\infty} c_n(x-a)^n \) be a formal power series. We define the radius of convergence \(R \) of this series to be the quantity \(R=\frac{1}{\limsup_{n \to \infty} \vert c_n \vert^{\frac{1}{n}} }\) with the convention \(\frac{1}{0} = +\infty \) and \(\frac{1}{+\infty } = 0\). 
\end{definition}

\begin{remark}
    The radius of convergence must be non-negative.
\end{remark}

\begin{lemma} \label{lm: series approaches limsup}
    Let \((a_n)\) be a sequence of real number. Suppose \(L = \limsup_{n \to \infty} a_n \in [0, \infty ) \), then for any \(\varepsilon > 0\), \(\exists N > 0\) s.t. \(a_n < L + \varepsilon \) for all \(n \ge N\).      
\end{lemma}
\begin{proof}
    If \(L = \infty \), then this is true. Now if \(L\) is a real number, then \(L = \lim_{n \to \infty} S_n \) where \(S_n = \sup _{k \ge n} a_k\). Given any \(\varepsilon > 0\), \(\exists N > 0\) s.t. \(\vert S_n - L \vert < \varepsilon  \) for all \(n \ge N\), so \(S_n < L + \varepsilon \) for all \(n \ge N\). Hence, 
    \[
        a_n \le \sup _{k \ge n} a_k = S_n < L + \varepsilon \quad \forall n \ge N.
    \]          
\end{proof}

\begin{lemma} \label{lm: given any veps we can find infinitely many an approach limsup in error veps}
    Let \((a_n)\) be a sequence of real numbers, and let \(p \coloneqq \limsup_{n \to \infty} a_n \). Then for every \(\varepsilon > 0\), \(\exists \) infinitely many indices \(n\) s.t. \(a_n > p - \varepsilon \).     
\end{lemma}
\begin{proof}
    We know \(p = \lim_{n \to \infty} S_n \) where \(S_n = \sup _{k \ge n} a_k\), so given \(\varepsilon > 0\), \(\exists N > 0\) s.t. 
    \[
        \left\vert S_n - p \right\vert < \frac{\varepsilon}{2} \quad \forall n \ge N,
    \] so \(p - \frac{\varepsilon}{2} < S_n = \sup _{k \ge n} a_k\), which means \(\exists k_1 \ge n\) s.t. \(p - \frac{\varepsilon}{2} < a_{k_1}\), and let \(n = k_1 + 1\) and repeat this step to get \(k_2\) and so on, then we know \(\left\{ k_n \right\} \) is an infinite set.     
\end{proof}

\begin{theorem}[Ratio Test] \label{thm: Ratio test}
    Suppose \(\lim_{n \to \infty} \left\vert \frac{a_{n+1}}{a_n} \right\vert = L \in [0, \infty )\). If \(L < 1\), then \(\sum_{n=0}^{\infty} a_n \) converges absolutely. If \(L > 1\), then \(\sum_{n=0}^{\infty} a_n \) diverges. If \(L = 1\), then no conclusion.      
\end{theorem}
\begin{proof}
    If \(L < 1\), then we know there exists \(r\) s.t. \(L < r < 1\), so there exists \(N > 0\) s.t. for all \(n \ge N\) we have 
    \[
        \left\vert \frac{a_{n+1}}{a_n} \right\vert \le r,
    \] so we know \(\vert a_{n+1} \vert \le r \vert a_n \vert  \) for all \(n \ge N\), which means \(\vert a_{n+k} \vert  \le r^k \vert a_n \vert \), so 
    \[
        \sum_{n=0}^{\infty} \vert a_n \vert  = \sum_{n=0}^{N-1} \vert a_n \vert + \sum_{k=0}^{\infty} \vert a_{N+k} \vert = C + \sum_{k=0}^{\infty} r^k \vert a_N \vert = C + \vert a_N \vert \sum_{k=0}^{\infty} r^k, 
    \] which means \(\sum_{n=0}^{\infty} \vert a_n \vert   \) is convergent since \(r < 1\).
    
    If \(L > 1\)(including \(L = \infty \)), then by the definition of limit, we know for some \(\varepsilon > 0\), there exists \(N > 0\) s.t.  
    \[
        \left\vert \frac{a_{n+1}}{a_n} \right\vert \ge 1 + \varepsilon   
    \] for all \(n \ge N\), and thus \(\vert a_{n+1} \vert \ge (1 + \varepsilon )\vert a_n \vert \) for all \(n \ge N\). In particular, there must exists some \(k > 0\) with \(\vert a_k \vert > 0\), otherwise \(L\) is not well-defined, and thus we know \(\lim_{n \to \infty} a_n \neq 0 \) since \(\vert a_n \vert \) is strictly increasing, so by \autoref{thm: if sum an converges, then lim an = 0}, we know \(\sum_{n=0}^{\infty} a_n \) diverges. 
    
    If \(L = 1\), then for example, we know \(\sum_{n=1}^{\infty} \frac{1}{n} \) diverges but \(\sum_{n=1}^{\infty} \frac{1}{n^2} \)converges.  
\end{proof}

\begin{theorem}
    Let \(\sum_{n=0}^{\infty} c_n (x - a)^n \) be a formal power series, and let \(R\) be its radius of convergence \(R = \frac{1}{\limsup_{n \to \infty} \vert c_n \vert^{\frac{1}{n}}  }\), then 
    \begin{itemize}
        \item [(a)] \(\sum_{n=0}^{\infty} c_n (x - a)^n \) diverges if \(\vert x-a \vert > R \). 
        \item [(b)] \(\sum_{n=0}^{\infty} c_n (x - a)^n \) converges absolutely if \(\vert x-a \vert < R \). 
        \item [(c)] \(\sum_{n=0}^{\infty} c_n (x - a)^n \) converges uniformly on \([a-r, a+r]\) when \(0 < r < R\). 
        \item [(d)] Let \(f(x) = \sum_{n=0}^{\infty} c_n (x-a)^n \), and if \(\vert x-a \vert < R \), then \(f\) is differentiable and for any \(0<r<R\), \(\sum_{n=1}^{\infty} n c_n (x-a)^{n-1} \) converges uniformly to \(f^{\prime} \) on \([a-r, a+r]\). 
        \item [(e)] For any \([y, z] \subset (a-R, a+R)\), 
        \[
            \int _y^z f(x) \, \mathrm{d} x = \sum_{n=0}^{\infty} \frac{c_n (z-a)^{n+1}}{n+1} - \sum_{n=0}^{\infty } \frac{c_n(y-a)^{n+1}}{n+1}.   
        \]
    \end{itemize}   
\end{theorem}
\begin{proof}[proof from (c) to (e)]
   Trivial by \autoref{thm: converges uniformly preserves lim of sum of Riemann integral}. We may have to show the radius of convergence remains the same to show that we can write 
   \[
    \sum_{n=0}^{\infty} \frac{c_n(z-a)^{n+1}}{n+1} - \frac{c_n(y-a)^{n+1}}{n+1} = \sum_{n=0}^{\infty} \frac{c_n(z-a)^{n+1}}{n+1} - \sum_{n=0}^{\infty} \frac{c_n(y-a)^{n+1}}{n+1}.   
   \] 
\end{proof}
\begin{proof}[proof of (a)]
    Write \(L\coloneqq \limsup_{n \to \infty} \vert c_n \vert^{\frac{1}{n}}  \), so \(L = \frac{1}{R}\). Now if \(\vert x - a \vert > R \), then let \(S = \vert x - a \vert > R \), and we have 
    \[
        \limsup_{n \to \infty} \left\vert c_n (x - a)^n \right\vert^{\frac{1}{n}} = \limsup_{n \to \infty} \vert c_n \vert^{\frac{1}{n}} \vert x - a \vert = \vert x - a \vert \limsup_{n \to \infty} \vert c_n \vert^{\frac{1}{n}} = SL = \frac{S}{R} > 1.  
    \] Choose \(\varepsilon > 0\) s.t. \(\frac{S}{R} - \varepsilon  > 1\). From \autoref{lm: given any veps we can find infinitely many an approach limsup in error veps}, there exists infinitely many \(n\) s.t. 
    \[
        \left\vert c_n \right\vert^{\frac{1}{n}} \vert x - a \vert > \frac{S}{R} - \varepsilon > 1,  
    \] so there are infinitely many \(n\) has \(\left\vert c_n (x-a)^n \right\vert > 1\), so \(\lim_{n \to \infty} c_n (x - a)^n \neq 0 \), and thus we know \(\sum_{n=0}^{\infty} c_n (x - a)^n \) diverges.           
\end{proof}
\begin{proof}[proof of (b)]
    If \(\vert x - a \vert < R \), then \(\frac{\vert x - a \vert }{R} < 1\) i.e. \(\vert x - a \vert L < 1\) (\(L\) is same as it is in proof of (a)). Now we have 
    \(\limsup_{n \to \infty} \vert c_n \vert^{\frac{1}{n}} = L  \), so we can choose \(\varepsilon > 0\) s.t. \(\vert x - a \vert(L + \varepsilon ) < 1 \), so there exists \(N > 0\) s.t. 
    \[
        \left\vert c_n \right\vert^{\frac{1}{n}} < L + \varepsilon \quad \forall n \ge N \iff \vert c_n \vert < (L + \varepsilon )^n \iff \left\vert c_n (x-a)^n \right\vert \le (L + \varepsilon )^n \vert x - a \vert^n     
    \] by \autoref{lm: series approaches limsup}, so 
    \[
        \sum_{n=0}^{\infty} \left\vert c_n (x - a)^n \right\vert \le \sum_{n=0}^{N-1} \left\vert c_n (x-a)^n \right\vert + \sum_{n=N}^{\infty} \left\vert c_n(x-a)^n \right\vert \le \sum_{n=0}^{N-1} \vert c_n \vert \vert x-a \vert^n + \sum_{n=N}^{\infty} \left\vert (L+ \varepsilon )(x-a) \right\vert^n            
    \] and R.H.S. converges since the left term is finite and for the right term we have \(\vert (L + \varepsilon )(x - a) \vert < 1 \). 
\end{proof}

\begin{proof}[proof of (c)]
    Now if \(\vert x - a \vert \le r < R \), then we can choose \(\varepsilon > 0\) s.t. \(q = (L + \varepsilon )r < 1\) since \(Lr = \frac{r}{R} < 1\) . Note that 
    \[
        \left\vert (L + \varepsilon )(x - a) \right\vert^n \le \left( (L + \varepsilon )r \right)^n = q^n,  
    \] and this is independent of \(x\). (Note that \(L > 0\) so we can get rid of the absolute value) Note that this means there exists \(N > 0\) s.t. 
    \begin{align*}
        \sum_{n=0}^{\infty} \left\lVert c_n(x-a)^n \right\rVert_\infty &= \sum_{n=0}^{\infty} \left\vert c_n r^n \right\vert = \sum_{n=0}^{N-1} \left\vert c_n r^n  \right\vert + \sum_{n=N}^{\infty} \left\vert c_n r^n \right\vert \\
        &= C + \sum_{n=N}^{\infty} \left\vert c_n^{\frac{1}{n}} r \right\vert^{n} \le C + \sum_{n=N}^{\infty} \left\vert (L +\varepsilon )r \right\vert^n \le C + \sum_{n=N}^{\infty } q^n, 
    \end{align*} 
    by \autoref{lm: series approaches limsup}, and we know this means \(\sum_{n=0}^{\infty} \left\lVert c_n (x - a)^n \right\rVert _\infty\) is convergent since \(q < 1\), so by \hyperref[thm: Weierstrass M-test (bounded and conti)]{Weierstrass \(M\)-test}, we know \(\sum_{n=0}^{\infty} c_n ( x - a )^n   \) converges uniformly.  
\end{proof}
\begin{proof}[proof of (d)]
    Suppose \(S_N(x) = \sum_{n=0}^N c_n (x-a)^n \) and
    \[
        S_N^{\prime} (x) = \sum_{n=1}^N n c_n (x - a)^{n-1} = \sum_{n=0}^{N-1} (n+1)c_{n+1} (x-a)^n.  
    \] Then, we know \(S_N^{\prime} \) is continuous for all \(N > 0\). Now we claim that the radius of convergence of \(\sum_{n=0}^{\infty} (n+1) c_{n+1} (x - a)^n \) is \(R\). Note that 
    \[
        \limsup_{n \to \infty} \left\vert (n+1) c_{n+1} \right\vert ^{\frac{1}{n}} = \lim_{n \to \infty} \sup _{k \ge n} (k+1)^{\frac{1}{k}} \left\vert c_{k+1} \right\vert ^{\frac{1}{k}} = \lim_{n \to \infty} (n+1)^{\frac{1}{n}} \sup _{k \ge n} \left\vert c_{k+1} \right\vert ^{\frac{1}{k}}.
    \] Note that we can show that \(\lim_{n \to \infty} (n+1)^{\frac{1}{n}} = 1 \), which is easy, so we skip here, and we have
    \begin{align*}
        \limsup_{n \to \infty} \left\vert (n+1) c_{n+1} \right\vert^{\frac{1}{n}} &= \lim_{n \to \infty} (n+1)^{\frac{1}{n}} \sup _{k \ge n} \vert c_{k+1} \vert^{\frac{1}{k}} = \lim_{n \to \infty} (n+1)^{\frac{1}{n}} \lim_{n \to \infty} \sup _{k \ge n} \left\vert c_{k+1} \right\vert^{\frac{1}{k}} \\ &= \lim_{n \to \infty} \sup _{k \ge n} \vert c_{k+1} \vert^{\frac{1}{k}} = \limsup_{n \to \infty} \left\vert c_{n+1} \right\vert^{\frac{1}{n}}.  
    \end{align*}
    Now we show that \(\limsup_{n \to \infty} \vert c_{n+1} \vert^{\frac{1}{n}} = \limsup_{n \to \infty} \vert c_n \vert^{\frac{1}{n}} = L \). For all \(\varepsilon > 0\), there exists \(N > 0\) s.t. for all \(n \ge N\) we have 
    \[
        \vert c_n \vert^{\frac{1}{n}} < L + \varepsilon \iff \left\vert c_{n+1} \right\vert^{\frac{1}{n+1}} < L + \varepsilon \iff \left\vert c_{n+1} \right\vert^{\frac{1}{n}} < (L + \varepsilon )^{\frac{n+1}{n}} = (L + \varepsilon )^{1 + \frac{1}{n}}. 
    \] Hence, we have 
    \[
        \sup _{k \ge n} \vert c_{k+1} \vert^{\frac{1}{k}} \le (L + \varepsilon )^{1 + \frac{1}{n}} \quad \forall n \ge N 
    \] since \((L + \varepsilon )^{1 + \frac{1}{n}} \ge (L + \varepsilon )^{1 + \frac{1}{k}} > \vert c_{k+1} \vert^{\frac{1}{k}} \) for all \(k \ge n\). Hence, we know 
    \[
        \lim_{n \to \infty} \sup _{k \ge n} \left\vert c_{k+1} \right\vert^{\frac{1}{k}} \le \lim_{n \to \infty} (L + \varepsilon )^{1 +\frac{1}{n}} = L + \varepsilon .  
    \] Since for every \(\varepsilon > 0\) this is true, so \(\lim_{n \to \infty} \sup _{k \ge n} \vert c_{k+1} \vert^{\frac{1}{k}} \le L  \). Now we show 
    \[
        \lim_{n \to \infty} \sup _{k \ge n} \vert c_{k+1} \vert^{\frac{1}{k}} \ge L,  
    \] and then we can conclude that
    \[
        \lim_{n \to \infty} \sup _{k \ge n} \vert c_{k+1} \vert^{\frac{1}{n}} = L = \lim_{n \to \infty} \sup _{k \ge N} \vert c_n \vert^{\frac{1}{n}}.
    \]
    For all \(\varepsilon > 0\), we know there exists infinitely many \(n\) has 
    \[
        \vert c_n \vert^{\frac{1}{n}} > L - \varepsilon. 
    \] Hence, for every \(n \in \mathbb{N} \), there exists \(s_n > n\) has \(\vert c_{s_n} \vert^{\frac{1}{s_n}} > L - \varepsilon  \), and we collect \(\left\{ s_n \right\}_{n=1}^{\infty}  \). Thus, we have 
    \[
        \left\vert c_{s_n} \right\vert^{\frac{1}{s_n - 1}} > (L - \varepsilon )^{\frac{s_n}{s_n - 1}} = (L - \varepsilon )^{1 + \frac{1}{s_n - 1}} 
    \] for all \(s_n\). This means 
    \[
        \sup _{k \ge n} \vert c_{k+1} \vert^{\frac{1}{k}} \ge \vert c_{(s_{n+1} - 1) + 1} \vert^{\frac{1}{s_{n+1} - 1}} = \vert c_{s_{n+1}} \vert^{\frac{1}{s_{n+1} - 1}} > (L - \varepsilon )^{1 + \frac{1}{s_{n+1} - 1}},   
    \] and thus 
    \[
        \lim_{n \to \infty} \sup _{k \ge n} \left\vert c_{k+1} \right\vert^{\frac{1}{k}} > \lim_{n \to \infty} (L - \varepsilon )^{1 + \frac{1}{s_{n+1} - 1}} = (L -\varepsilon ) \lim_{n \to \infty} (L - \varepsilon )^{\frac{1}{s_{n+1} - 1}} = L - \varepsilon  
    \] since \(s_{n+1} - 1 > n\). Note that this is true for all \(\varepsilon > 0\), so we know \(\lim_{n \to \infty} \sup _{k \ge n} \vert c_{k+1} \vert^{\frac{1}{k}} \ge L  \), and we're done. 
    
    Now since we know the radius of convergence of \(\lim_{n \to \infty} S_n^{\prime}  \) is \(R\), so by (c) we know \(S_n^{\prime} \) converges uniformly to \(\sum_{n=0}^{\infty} (n+1)c_{n+1}(x-a)^n \) since from the problem condition we have \(\vert x - a \vert < R \). Also, we know \(\lim_{n \to \infty} S_n(a) = 0 \), which means the limit exists, so by \autoref{thm: f_n differentiable and f_n prime conti, then if f_n prime to g uni, and for some x0 lim f_n(x_0) exists, then EE f s.t. lim fn equal f uni and f prime is g}, we know there exists \(f\) s.t. \(S_N \to f\) uniformly and \(f^{\prime} = g\) if we let \(S_n^{\prime} \to g\) uniformly. This means \(S_n^{\prime} \to f^{\prime} \) uniformly, where \(f = \sum_{n=0}^{\infty} c_n (x-a)^n \), and thus 
    \[
        S_n^{\prime} = \sum_{n=0}^{\infty} (n+1)c_{n+1}(x-a)^n \to f^{\prime} 
    \] uniformly.
\end{proof}

\begin{remark}
    If \(\left\vert x - a \right\vert = R\), then \(\sum_{n=0}^{\infty} c_n(x-a)^n \) may converge or diverge, and there is no conclusion.  
\end{remark}